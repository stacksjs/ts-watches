// FIT Protocol Constants
// Based on FIT SDK Profile.xlsx

export const FIT_HEADER_SIZE = 14
export const FIT_HEADER_SIZE_LEGACY = 12
export const FIT_SIGNATURE = '.FIT'

// Base Types
export const BASE_TYPES = {
  ENUM: 0x00,
  SINT8: 0x01,
  UINT8: 0x02,
  SINT16: 0x83,
  UINT16: 0x84,
  SINT32: 0x85,
  UINT32: 0x86,
  STRING: 0x07,
  FLOAT32: 0x88,
  FLOAT64: 0x89,
  UINT8Z: 0x0A,
  UINT16Z: 0x8B,
  UINT32Z: 0x8C,
  BYTE: 0x0D,
  SINT64: 0x8E,
  UINT64: 0x8F,
  UINT64Z: 0x90,
} as const

export const BASE_TYPE_SIZES: Record<number, number> = {
  [BASE_TYPES.ENUM]: 1,
  [BASE_TYPES.SINT8]: 1,
  [BASE_TYPES.UINT8]: 1,
  [BASE_TYPES.SINT16]: 2,
  [BASE_TYPES.UINT16]: 2,
  [BASE_TYPES.SINT32]: 4,
  [BASE_TYPES.UINT32]: 4,
  [BASE_TYPES.STRING]: 1,
  [BASE_TYPES.FLOAT32]: 4,
  [BASE_TYPES.FLOAT64]: 8,
  [BASE_TYPES.UINT8Z]: 1,
  [BASE_TYPES.UINT16Z]: 2,
  [BASE_TYPES.UINT32Z]: 4,
  [BASE_TYPES.BYTE]: 1,
  [BASE_TYPES.SINT64]: 8,
  [BASE_TYPES.UINT64]: 8,
  [BASE_TYPES.UINT64Z]: 8,
}

// Global Message Numbers
export const MESG_NUM = {
  FILE_ID: 0,
  CAPABILITIES: 1,
  DEVICE_SETTINGS: 2,
  USER_PROFILE: 3,
  HRM_PROFILE: 4,
  SDM_PROFILE: 5,
  BIKE_PROFILE: 6,
  ZONES_TARGET: 7,
  HR_ZONE: 8,
  POWER_ZONE: 9,
  MET_ZONE: 10,
  SPORT: 12,
  GOAL: 15,
  SESSION: 18,
  LAP: 19,
  RECORD: 20,
  EVENT: 21,
  DEVICE_INFO: 23,
  WORKOUT: 26,
  WORKOUT_STEP: 27,
  SCHEDULE: 28,
  WEIGHT_SCALE: 30,
  COURSE: 31,
  COURSE_POINT: 32,
  TOTALS: 33,
  ACTIVITY: 34,
  SOFTWARE: 35,
  FILE_CAPABILITIES: 37,
  MESG_CAPABILITIES: 38,
  FIELD_CAPABILITIES: 39,
  FILE_CREATOR: 49,
  BLOOD_PRESSURE: 51,
  SPEED_ZONE: 53,
  MONITORING: 55,
  TRAINING_FILE: 72,
  HRV: 78,
  ANT_RX: 80,
  ANT_TX: 81,
  ANT_CHANNEL_ID: 82,
  LENGTH: 101,
  MONITORING_INFO: 103,
  PAD: 105,
  SLAVE_DEVICE: 106,
  CONNECTIVITY: 127,
  WEATHER_CONDITIONS: 128,
  WEATHER_ALERT: 129,
  CADENCE_ZONE: 131,
  HR: 132,
  SEGMENT_LAP: 142,
  MEMO_GLOB: 145,
  SEGMENT_ID: 148,
  SEGMENT_LEADERBOARD_ENTRY: 149,
  SEGMENT_POINT: 150,
  SEGMENT_FILE: 151,
  WORKOUT_SESSION: 158,
  WATCHFACE_SETTINGS: 159,
  GPS_METADATA: 160,
  CAMERA_EVENT: 161,
  TIMESTAMP_CORRELATION: 162,
  GYROSCOPE_DATA: 164,
  ACCELEROMETER_DATA: 165,
  THREE_D_SENSOR_CALIBRATION: 167,
  VIDEO_FRAME: 169,
  OBDII_DATA: 174,
  NMEA_SENTENCE: 177,
  AVIATION_ATTITUDE: 178,
  VIDEO: 184,
  VIDEO_TITLE: 185,
  VIDEO_DESCRIPTION: 186,
  VIDEO_CLIP: 187,
  OHR_SETTINGS: 188,
  EXD_SCREEN_CONFIGURATION: 200,
  EXD_DATA_FIELD_CONFIGURATION: 201,
  EXD_DATA_CONCEPT_CONFIGURATION: 202,
  FIELD_DESCRIPTION: 206,
  DEVELOPER_DATA_ID: 207,
  MAGNETOMETER_DATA: 208,
  BAROMETER_DATA: 209,
  ONE_D_SENSOR_CALIBRATION: 210,
  MONITORING_HR_DATA: 211,
  TIME_IN_ZONE: 216,
  SET: 225,
  STRESS_LEVEL: 227,
  MAX_MET_DATA: 229,
  DIVE_SETTINGS: 258,
  DIVE_GAS: 259,
  DIVE_ALARM: 262,
  EXERCISE_TITLE: 264,
  DIVE_SUMMARY: 268,
  SPO2_DATA: 269,
  SLEEP_LEVEL: 275,
  JUMP: 285,
  BEAT_INTERVALS: 290,
  RESPIRATION_RATE: 297,
  SPLIT: 312,
  CLIMB_PRO: 317,
  TANK_UPDATE: 319,
  TANK_SUMMARY: 323,
  SLEEP_ASSESSMENT: 346,
  HRV_STATUS_SUMMARY: 370,
  HRV_VALUE: 371,
  DEVICE_AUX_BATTERY_INFO: 375,
  DIVE_APNEA_ALARM: 393,
  SKIN_TEMP_OVERNIGHT: 398,
} as const

// Field Definition Numbers for common message types
export const FIELD_DEF = {
  // File ID Message (0)
  FILE_ID: {
    TYPE: 0,
    MANUFACTURER: 1,
    PRODUCT: 2,
    SERIAL_NUMBER: 3,
    TIME_CREATED: 4,
    NUMBER: 5,
    PRODUCT_NAME: 8,
  },

  // Session Message (18)
  SESSION: {
    TIMESTAMP: 253,
    START_TIME: 2,
    START_POSITION_LAT: 3,
    START_POSITION_LONG: 4,
    TOTAL_ELAPSED_TIME: 7,
    TOTAL_TIMER_TIME: 8,
    TOTAL_DISTANCE: 9,
    TOTAL_CYCLES: 10,
    TOTAL_CALORIES: 11,
    TOTAL_FAT_CALORIES: 13,
    AVG_SPEED: 14,
    MAX_SPEED: 15,
    AVG_HEART_RATE: 16,
    MAX_HEART_RATE: 17,
    AVG_CADENCE: 18,
    MAX_CADENCE: 19,
    AVG_POWER: 20,
    MAX_POWER: 21,
    TOTAL_ASCENT: 22,
    TOTAL_DESCENT: 23,
    SPORT: 5,
    SUB_SPORT: 6,
    EVENT: 0,
    EVENT_TYPE: 1,
    FIRST_LAP_INDEX: 25,
    NUM_LAPS: 26,
    NORMALIZED_POWER: 34,
    TRAINING_STRESS_SCORE: 35,
    INTENSITY_FACTOR: 36,
    AVG_TEMPERATURE: 57,
    MAX_TEMPERATURE: 58,
  },

  // Lap Message (19)
  LAP: {
    TIMESTAMP: 253,
    EVENT: 0,
    EVENT_TYPE: 1,
    START_TIME: 2,
    START_POSITION_LAT: 3,
    START_POSITION_LONG: 4,
    END_POSITION_LAT: 5,
    END_POSITION_LONG: 6,
    TOTAL_ELAPSED_TIME: 7,
    TOTAL_TIMER_TIME: 8,
    TOTAL_DISTANCE: 9,
    TOTAL_CYCLES: 10,
    TOTAL_CALORIES: 11,
    TOTAL_FAT_CALORIES: 12,
    AVG_SPEED: 13,
    MAX_SPEED: 14,
    AVG_HEART_RATE: 15,
    MAX_HEART_RATE: 16,
    AVG_CADENCE: 17,
    MAX_CADENCE: 18,
    AVG_POWER: 19,
    MAX_POWER: 20,
    TOTAL_ASCENT: 21,
    TOTAL_DESCENT: 22,
    SPORT: 23,
    SUB_SPORT: 24,
    AVG_TEMPERATURE: 50,
    MAX_TEMPERATURE: 51,
  },

  // Record Message (20)
  RECORD: {
    TIMESTAMP: 253,
    POSITION_LAT: 0,
    POSITION_LONG: 1,
    ALTITUDE: 2,
    HEART_RATE: 3,
    CADENCE: 4,
    DISTANCE: 5,
    SPEED: 6,
    POWER: 7,
    COMPRESSED_SPEED_DISTANCE: 8,
    GRADE: 9,
    RESISTANCE: 10,
    TIME_FROM_COURSE: 11,
    CYCLE_LENGTH: 12,
    TEMPERATURE: 13,
    SPEED_1S: 17,
    CYCLES: 18,
    TOTAL_CYCLES: 19,
    COMPRESSED_ACCUMULATED_POWER: 28,
    ACCUMULATED_POWER: 29,
    LEFT_RIGHT_BALANCE: 30,
    GPS_ACCURACY: 31,
    VERTICAL_SPEED: 32,
    CALORIES: 33,
    VERTICAL_OSCILLATION: 39,
    STANCE_TIME_PERCENT: 40,
    STANCE_TIME: 41,
    ACTIVITY_TYPE: 42,
    LEFT_TORQUE_EFFECTIVENESS: 43,
    RIGHT_TORQUE_EFFECTIVENESS: 44,
    LEFT_PEDAL_SMOOTHNESS: 45,
    RIGHT_PEDAL_SMOOTHNESS: 46,
    COMBINED_PEDAL_SMOOTHNESS: 47,
    TIME128: 48,
    STROKE_TYPE: 49,
    ZONE: 50,
    BALL_SPEED: 51,
    CADENCE256: 52,
    FRACTIONAL_CADENCE: 53,
    TOTAL_HEMOGLOBIN_CONC: 54,
    TOTAL_HEMOGLOBIN_CONC_MIN: 55,
    TOTAL_HEMOGLOBIN_CONC_MAX: 56,
    SATURATED_HEMOGLOBIN_PERCENT: 57,
    SATURATED_HEMOGLOBIN_PERCENT_MIN: 58,
    SATURATED_HEMOGLOBIN_PERCENT_MAX: 59,
    DEVICE_INDEX: 62,
    LEFT_PCO: 67,
    RIGHT_PCO: 68,
    LEFT_POWER_PHASE: 69,
    LEFT_POWER_PHASE_PEAK: 70,
    RIGHT_POWER_PHASE: 71,
    RIGHT_POWER_PHASE_PEAK: 72,
    ENHANCED_SPEED: 73,
    ENHANCED_ALTITUDE: 78,
    BATTERY_SOC: 81,
    MOTOR_POWER: 82,
    VERTICAL_RATIO: 83,
    STANCE_TIME_BALANCE: 84,
    STEP_LENGTH: 85,
    ABSOLUTE_PRESSURE: 91,
    DEPTH: 92,
    NEXT_STOP_DEPTH: 93,
    NEXT_STOP_TIME: 94,
    TIME_TO_SURFACE: 95,
    NDL_TIME: 96,
    CNS_LOAD: 97,
    N2_LOAD: 98,
    RESPIRATION_RATE: 99,
    ENHANCED_RESPIRATION_RATE: 108,
    GRIT: 114,
    FLOW: 115,
    CURRENT_STRESS: 116,
    EBIKE_TRAVEL_RANGE: 117,
    EBIKE_BATTERY_LEVEL: 118,
    EBIKE_ASSIST_MODE: 119,
    EBIKE_ASSIST_LEVEL_PERCENT: 120,
    AIR_TIME_REMAINING: 123,
    PRESSURE_SAC: 124,
    VOLUME_SAC: 125,
    RMV: 126,
    ASCENT_RATE: 127,
    PO2: 129,
    CORE_TEMPERATURE: 139,
  },

  // Activity Message (34)
  ACTIVITY: {
    TIMESTAMP: 253,
    TOTAL_TIMER_TIME: 0,
    NUM_SESSIONS: 1,
    TYPE: 2,
    EVENT: 3,
    EVENT_TYPE: 4,
    LOCAL_TIMESTAMP: 5,
    EVENT_GROUP: 6,
  },

  // Monitoring Message (55)
  MONITORING: {
    TIMESTAMP: 253,
    DEVICE_INDEX: 0,
    CALORIES: 1,
    DISTANCE: 2,
    CYCLES: 3,
    ACTIVE_TIME: 4,
    ACTIVITY_TYPE: 5,
    ACTIVITY_SUBTYPE: 6,
    ACTIVITY_LEVEL: 7,
    DISTANCE_16: 8,
    CYCLES_16: 9,
    ACTIVE_TIME_16: 10,
    LOCAL_TIMESTAMP: 11,
    TEMPERATURE: 12,
    TEMPERATURE_MIN: 14,
    TEMPERATURE_MAX: 15,
    ACTIVITY_TIME: 16,
    ACTIVE_CALORIES: 19,
    CURRENT_ACTIVITY_TYPE_INTENSITY: 24,
    TIMESTAMP_MIN_8: 25,
    TIMESTAMP_16: 26,
    HEART_RATE: 27,
    INTENSITY: 28,
    DURATION_MIN: 29,
    DURATION: 30,
    ASCENT: 31,
    DESCENT: 32,
    MODERATE_ACTIVITY_MINUTES: 33,
    VIGOROUS_ACTIVITY_MINUTES: 34,
  },

  // HRV Message (78)
  HRV: {
    TIME: 0,
  },

  // Stress Level Message (227)
  STRESS_LEVEL: {
    STRESS_LEVEL_VALUE: 0,
    STRESS_LEVEL_TIME: 1,
  },

  // SpO2 Data Message (269)
  SPO2_DATA: {
    TIMESTAMP: 253,
    READING_SPO2: 0,
    READING_CONFIDENCE: 1,
    MODE: 2,
  },

  // Sleep Level Message (275)
  SLEEP_LEVEL: {
    TIMESTAMP: 253,
    SLEEP_LEVEL: 0,
  },

  // Respiration Rate Message (297)
  RESPIRATION_RATE: {
    TIMESTAMP: 253,
    RESPIRATION_RATE: 0,
  },

  // Device Info Message (23)
  DEVICE_INFO: {
    TIMESTAMP: 253,
    DEVICE_INDEX: 0,
    DEVICE_TYPE: 1,
    MANUFACTURER: 2,
    SERIAL_NUMBER: 3,
    PRODUCT: 4,
    SOFTWARE_VERSION: 5,
    HARDWARE_VERSION: 6,
    CUM_OPERATING_TIME: 7,
    BATTERY_VOLTAGE: 10,
    BATTERY_STATUS: 11,
    SENSOR_POSITION: 18,
    DESCRIPTOR: 19,
    ANT_TRANSMISSION_TYPE: 20,
    ANT_DEVICE_NUMBER: 21,
    ANT_NETWORK: 22,
    SOURCE_TYPE: 25,
    PRODUCT_NAME: 27,
    BATTERY_LEVEL: 32,
  },
} as const

// Sport Types
export const SPORT = {
  GENERIC: 0,
  RUNNING: 1,
  CYCLING: 2,
  TRANSITION: 3,
  FITNESS_EQUIPMENT: 4,
  SWIMMING: 5,
  BASKETBALL: 6,
  SOCCER: 7,
  TENNIS: 8,
  AMERICAN_FOOTBALL: 9,
  TRAINING: 10,
  WALKING: 11,
  CROSS_COUNTRY_SKIING: 12,
  ALPINE_SKIING: 13,
  SNOWBOARDING: 14,
  ROWING: 15,
  MOUNTAINEERING: 16,
  HIKING: 17,
  MULTISPORT: 18,
  PADDLING: 19,
  FLYING: 20,
  E_BIKING: 21,
  MOTORCYCLING: 22,
  BOATING: 23,
  DRIVING: 24,
  GOLF: 25,
  HANG_GLIDING: 26,
  HORSEBACK_RIDING: 27,
  HUNTING: 28,
  FISHING: 29,
  INLINE_SKATING: 30,
  ROCK_CLIMBING: 31,
  SAILING: 32,
  ICE_SKATING: 33,
  SKY_DIVING: 34,
  SNOWSHOEING: 35,
  SNOWMOBILING: 36,
  STAND_UP_PADDLEBOARDING: 37,
  SURFING: 38,
  WAKEBOARDING: 39,
  WATER_SKIING: 40,
  KAYAKING: 41,
  RAFTING: 42,
  WINDSURFING: 43,
  KITESURFING: 44,
  TACTICAL: 45,
  JUMPMASTER: 46,
  BOXING: 47,
  FLOOR_CLIMBING: 48,
  DIVING: 53,
  HIIT: 62,
  RACKET: 64,
  WHEELCHAIR_PUSH_WALK: 65,
  WHEELCHAIR_PUSH_RUN: 66,
  MEDITATION: 67,
  DISC_GOLF: 69,
  CRICKET: 82,
  RUGBY: 83,
  HOCKEY: 84,
  LACROSSE: 85,
  VOLLEYBALL: 86,
  WATER_TUBING: 87,
  WAKESURFING: 88,
  MIXED_MARTIAL_ARTS: 105,
  SNORKELING: 109,
  YOGA: 123,
  PILATES: 124,
  INDOOR_RUNNING: 125,
  INDOOR_CYCLING: 126,
  BREATHWORK: 134,
  ALL: 254,
} as const

// Sub-Sport Types
export const SUB_SPORT = {
  GENERIC: 0,
  TREADMILL: 1,
  STREET: 2,
  TRAIL: 3,
  TRACK: 4,
  SPIN: 5,
  INDOOR_CYCLING: 6,
  ROAD: 7,
  MOUNTAIN: 8,
  DOWNHILL: 9,
  RECUMBENT: 10,
  CYCLOCROSS: 11,
  HAND_CYCLING: 12,
  TRACK_CYCLING: 13,
  INDOOR_ROWING: 14,
  ELLIPTICAL: 15,
  STAIR_CLIMBING: 16,
  LAP_SWIMMING: 17,
  OPEN_WATER: 18,
  FLEXIBILITY_TRAINING: 19,
  STRENGTH_TRAINING: 20,
  WARM_UP: 21,
  MATCH: 22,
  EXERCISE: 23,
  CHALLENGE: 24,
  INDOOR_SKIING: 25,
  CARDIO_TRAINING: 26,
  INDOOR_WALKING: 27,
  E_BIKE_FITNESS: 28,
  BMX: 29,
  CASUAL_WALKING: 30,
  SPEED_WALKING: 31,
  BIKE_TO_RUN_TRANSITION: 32,
  RUN_TO_BIKE_TRANSITION: 33,
  SWIM_TO_BIKE_TRANSITION: 34,
  ATV: 35,
  MOTOCROSS: 36,
  BACKCOUNTRY: 37,
  RESORT: 38,
  RC_DRONE: 39,
  WINGSUIT: 40,
  WHITEWATER: 41,
  SKATE_SKIING: 42,
  YOGA: 43,
  PILATES: 44,
  INDOOR_RUNNING: 45,
  GRAVEL_CYCLING: 46,
  E_BIKE_MOUNTAIN: 47,
  COMMUTING: 48,
  MIXED_SURFACE: 49,
  NAVIGATE: 50,
  TRACK_ME: 51,
  MAP: 52,
  SINGLE_GAS_DIVING: 53,
  MULTI_GAS_DIVING: 54,
  GAUGE_DIVING: 55,
  APNEA_DIVING: 56,
  APNEA_HUNTING: 57,
  VIRTUAL_ACTIVITY: 58,
  OBSTACLE: 59,
  BREATHING: 62,
  SAIL_RACE: 65,
  ULTRA: 67,
  INDOOR_CLIMBING: 68,
  BOULDERING: 69,
  HIIT: 70,
  AMRAP: 73,
  EMOM: 74,
  TABATA: 75,
  PICKLEBALL: 84,
  PADEL: 85,
  INDOOR_WHEELCHAIR_WALK: 86,
  INDOOR_WHEELCHAIR_RUN: 87,
  INDOOR_HAND_CYCLING: 88,
  FLY: 110,
  ALL: 254,
} as const

// Sleep Level Types
export const SLEEP_LEVEL = {
  UNMEASURABLE: 0,
  AWAKE: 1,
  LIGHT: 2,
  DEEP: 3,
  REM: 4,
} as const

// FIT Epoch (Dec 31, 1989 00:00:00 UTC)
export const FIT_EPOCH: number = Date.UTC(1989, 11, 31, 0, 0, 0)

// Manufacturer IDs
export const MANUFACTURER = {
  GARMIN: 1,
  GARMIN_FR405_ANTFS: 2,
  ZEPHYR: 3,
  DAYTON: 4,
  IDT: 5,
  SRM: 6,
  QUARQ: 7,
  IBIKE: 8,
  SARIS: 9,
  SPARK_HK: 10,
  TANITA: 11,
  ECHOWELL: 12,
  DYNASTREAM_OEM: 13,
  NAUTILUS: 14,
  DYNASTREAM: 15,
  TIMEX: 16,
  METRIGEAR: 17,
  XELIC: 18,
  BEURER: 19,
  CARDIOSPORT: 20,
  A_AND_D: 21,
  HMM: 22,
  SUUNTO: 23,
  THITA_ELEKTRONIK: 24,
  GPULSE: 25,
  CLEAN_MOBILE: 26,
  PEDAL_BRAIN: 27,
  PEAKSWARE: 28,
  SAXONAR: 29,
  LEMOND_FITNESS: 30,
  DEXCOM: 31,
  WAHOO_FITNESS: 32,
  OCTANE_FITNESS: 33,
  ARCHINOETICS: 34,
  THE_HURT_BOX: 35,
  CITIZEN_SYSTEMS: 36,
  MAGELLAN: 37,
  OSYNCE: 38,
  HOLUX: 39,
  CONCEPT2: 40,
  SHIMANO: 72,
  PIONEER: 86,
  BRYTON: 267,
  ZWIFT: 260,
  WAHOO: 32,
  TACX: 89,
} as const
